{"version":3,"file":"main.min.js","sources":["../../src/my-courses/main.js"],"sourcesContent":["/**\n * Bla-bla\n */\n\nimport {setWsToken} from \"../token\";\nimport {getMyCourses} from \"../api\";\nimport {courseCardTemplate} from \"./templates\";\nimport * as loading from \"../loading\";\nimport { getElement, setInstanceId } from \"../static-selectors\";\nimport {\n  FILTER_TYPES,\n  updateFilterState,\n  updateMainContainer,\n  initiateSearch,\n  updateCourseCount,\n  getFilterState,\n  prepareSortDropdown,\n  SORT_TYPES,\n} from \"../static-selectors\";\nimport {createPagination} from \"../pagination\";\n\nexport const init = ({wsToken, userid, instanceId}) => {\n  setInstanceId(instanceId);\n  setWsToken(wsToken);\n  loading.show();\n\n  getMyCourses(userid, (response) => {\n    if (!Array.isArray(response)) {\n      console.error(\"Expected array response but got:\", response);\n      return;\n    }\n\n    const courses = response;\n\n    const handleFilter = () => {\n      const filterStates = getFilterState();\n      let filteredCourses = courses.filter(course => course.ismaterial === false);\n\n      if (filterStates[FILTER_TYPES.QUERY]) {\n        const search = filterStates[FILTER_TYPES.QUERY].toLowerCase();\n        filteredCourses = filteredCourses.filter(course =>\n          course.title.toLowerCase().includes(search) ||\n          course.description.toLowerCase().includes(search)\n        );\n      }\n\n      if (filterStates.ORDER) {\n        const {direction, field} = SORT_TYPES[filterStates.ORDER];\n        filteredCourses.sort((a, b) => {\n          if (a[field] > b[field]) return direction;\n          if (a[field] < b[field]) return -direction;\n          return 0;\n        });\n      }\n\n      updateCourseCount(filteredCourses.length);\n      initiatePagination({\n        currentPage: filterStates.CURRENT_PAGE + 1,\n        total: filteredCourses.length,\n        perPage: filterStates.PAGE_SIZE,\n      });\n\n      updateMainContainer(\n        filteredCourses\n          .slice(filterStates.CURRENT_PAGE * filterStates.PAGE_SIZE, (filterStates.CURRENT_PAGE + 1) * filterStates.PAGE_SIZE)\n          .map(courseCardTemplate)\n      );\n\n      return filteredCourses;\n    };\n\n    const initiatePagination = ({currentPage, total, perPage}) => {\n      createPagination({\n        container: getElement(\"cebTopPaginationContainer\"),\n        currentPage,\n        total,\n        perPage,\n        onChange: (page) => {\n          if (updateFilterState(FILTER_TYPES.CURRENT_PAGE, page - 1)) {\n            handleFilter();\n          }\n        },\n      });\n\n      createPagination({\n        container: getElement(\"cebBottomPaginationContainer\"),\n        currentPage,\n        total,\n        perPage,\n        onChange: (page) => {\n          if (updateFilterState(FILTER_TYPES.CURRENT_PAGE, page - 1)) {\n            handleFilter();\n          }\n        },\n      });\n    };\n\n    initiateSearch(handleFilter);\n    prepareSortDropdown(handleFilter);\n    handleFilter();\n\n    setTimeout(() => loading.hide(), 1000);\n  });\n};\n"],"names":["_ref","wsToken","userid","instanceId","loading","show","response","Array","isArray","console","error","courses","handleFilter","filterStates","filteredCourses","filter","course","ismaterial","FILTER_TYPES","QUERY","search","toLowerCase","title","includes","description","ORDER","direction","field","SORT_TYPES","sort","a","b","length","initiatePagination","currentPage","CURRENT_PAGE","total","perPage","PAGE_SIZE","slice","map","courseCardTemplate","_ref2","container","onChange","page","setTimeout","hide"],"mappings":"4uCAqBoBA,WAACC,QAACA,QAADC,OAAUA,OAAVC,WAAkBA,oDACvBA,kCACHF,SACXG,QAAQC,6BAEKH,QAASI,eACfC,MAAMC,QAAQF,sBACjBG,QAAQC,MAAM,mCAAoCJ,gBAI9CK,QAAUL,SAEVM,aAAe,WACbC,cAAe,yCACjBC,gBAAkBH,QAAQI,QAAOC,SAAgC,IAAtBA,OAAOC,gBAElDJ,aAAaK,8BAAaC,OAAQ,OAC9BC,OAASP,aAAaK,8BAAaC,OAAOE,cAChDP,gBAAkBA,gBAAgBC,QAAOC,QACvCA,OAAOM,MAAMD,cAAcE,SAASH,SACpCJ,OAAOQ,YAAYH,cAAcE,SAASH,aAI1CP,aAAaY,MAAO,OAChBC,UAACA,UAADC,MAAYA,OAASC,4BAAWf,aAAaY,OACnDX,gBAAgBe,MAAK,CAACC,EAAGC,IACnBD,EAAEH,OAASI,EAAEJ,OAAeD,UAC5BI,EAAEH,OAASI,EAAEJ,QAAgBD,UAC1B,iDAIOZ,gBAAgBkB,QAClCC,mBAAmB,CACjBC,YAAarB,aAAasB,aAAe,EACzCC,MAAOtB,gBAAgBkB,OACvBK,QAASxB,aAAayB,qDAItBxB,gBACGyB,MAAM1B,aAAasB,aAAetB,aAAayB,WAAYzB,aAAasB,aAAe,GAAKtB,aAAayB,WACzGE,IAAIC,gCAGF3B,iBAGHmB,mBAAqBS,YAACR,YAACA,YAADE,MAAcA,MAAdC,QAAqBA,gDAC9B,CACfM,WAAW,+BAAW,6BACtBT,YAAAA,YACAE,MAAAA,MACAC,QAAAA,QACAO,SAAWC,QACL,sCAAkB3B,8BAAaiB,aAAcU,KAAO,IACtDjC,mDAKW,CACf+B,WAAW,+BAAW,gCACtBT,YAAAA,YACAE,MAAAA,MACAC,QAAAA,QACAO,SAAWC,QACL,sCAAkB3B,8BAAaiB,aAAcU,KAAO,IACtDjC,uDAMOA,uDACKA,cACpBA,eAEAkC,YAAW,IAAM1C,QAAQ2C,QAAQ"}